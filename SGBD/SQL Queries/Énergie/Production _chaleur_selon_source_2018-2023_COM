-- Production de chaleur par source d'approvisionnement de 2018 à 2023 (Beauvais)
-- Tableaux : Conso_chaleur_froid_COM_2018  à Conso_chaleur_froid_COM_2023

WITH production_data AS (
  -- Gaz naturel
  SELECT 'Gaz naturel' as TYPE_PRODUCTION, PRODUCTION_GAZ_NATUREL as VALEUR, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Gaz naturel', PRODUCTION_GAZ_NATUREL, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Gaz naturel', PRODUCTION_GAZ_NATUREL, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Gaz naturel', PRODUCTION_GAZ_NATUREL, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Gaz naturel', PRODUCTION_GAZ_NATUREL, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Gaz naturel', PRODUCTION_GAZ_NATUREL, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Charbon
  SELECT 'Charbon', PRODUCTION_CHARBON, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Charbon', PRODUCTION_CHARBON, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Charbon', PRODUCTION_CHARBON, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Charbon', PRODUCTION_CHARBON, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Charbon', PRODUCTION_CHARBON, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Charbon', PRODUCTION_CHARBON, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Fioul domestique
  SELECT 'Fioul domestique', PRODUCTION_FIOUL_DOMESTIQUE, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Fioul domestique', PRODUCTION_FIOUL_DOMESTIQUE, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Fioul domestique', PRODUCTION_FIOUL_DOMESTIQUE, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Fioul domestique', PRODUCTION_FIOUL_DOMESTIQUE, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Fioul domestique', PRODUCTION_FIOUL_DOMESTIQUE, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Fioul domestique', PRODUCTION_FIOUL_DOMESTIQUE, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Fioul lourd
  SELECT 'Fioul lourd', PRODUCTION_FIOUL_LOURD, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Fioul lourd', PRODUCTION_FIOUL_LOURD, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Fioul lourd', PRODUCTION_FIOUL_LOURD, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Fioul lourd', PRODUCTION_FIOUL_LOURD, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Fioul lourd', PRODUCTION_FIOUL_LOURD, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Fioul lourd', PRODUCTION_FIOUL_LOURD, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- GPL
  SELECT 'GPL', PRODUCTION_GPL, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'GPL', PRODUCTION_GPL, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'GPL', PRODUCTION_GPL, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'GPL', PRODUCTION_GPL, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'GPL', PRODUCTION_GPL, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'GPL', PRODUCTION_GPL, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Biomasse solide
  SELECT 'Biomasse solide', PRODUCTION_BIOMASSE_SOLIDE, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Biomasse solide', PRODUCTION_BIOMASSE_SOLIDE, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Biomasse solide', PRODUCTION_BIOMASSE_SOLIDE, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Biomasse solide', PRODUCTION_BIOMASSE_SOLIDE, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Biomasse solide', PRODUCTION_BIOMASSE_SOLIDE, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Biomasse solide', PRODUCTION_BIOMASSE_SOLIDE, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Déchets internes
  SELECT 'Déchets internes', PRODUCTION_DECHETS_INTERNES, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Déchets internes', PRODUCTION_DECHETS_INTERNES, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Déchets internes', PRODUCTION_DECHETS_INTERNES, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Déchets internes', PRODUCTION_DECHETS_INTERNES, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Déchets internes', PRODUCTION_DECHETS_INTERNES, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Déchets internes', PRODUCTION_DECHETS_INTERNES, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- UIOM
  SELECT 'UIOM', PRODUCTION_UIOM, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'UIOM', PRODUCTION_UIOM, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'UIOM', PRODUCTION_UIOM, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'UIOM', PRODUCTION_UIOM, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'UIOM', PRODUCTION_UIOM, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'UIOM', PRODUCTION_UIOM, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Biogaz
  SELECT 'Biogaz', PRODUCTION_BIOGAZ, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Biogaz', PRODUCTION_BIOGAZ, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Biogaz', PRODUCTION_BIOGAZ, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Biogaz', PRODUCTION_BIOGAZ, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Biogaz', PRODUCTION_BIOGAZ, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Biogaz', PRODUCTION_BIOGAZ, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Géothermie
  SELECT 'Géothermie', PRODUCTION_GEOTHERMIE, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Géothermie', PRODUCTION_GEOTHERMIE, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Géothermie', PRODUCTION_GEOTHERMIE, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Géothermie', PRODUCTION_GEOTHERMIE, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Géothermie', PRODUCTION_GEOTHERMIE, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Géothermie', PRODUCTION_GEOTHERMIE, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Pompes à chaleur
  SELECT 'Pompes à chaleur', PRODUCTION_PAC, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Pompes à chaleur', PRODUCTION_PAC, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Pompes à chaleur', PRODUCTION_PAC, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Pompes à chaleur', PRODUCTION_PAC, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Pompes à chaleur', PRODUCTION_PAC, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Pompes à chaleur', PRODUCTION_PAC, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Solaire thermique
  SELECT 'Solaire thermique', PRODUCTION_SOLAIRE_THERMIQUE, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Solaire thermique', PRODUCTION_SOLAIRE_THERMIQUE, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Solaire thermique', PRODUCTION_SOLAIRE_THERMIQUE, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Solaire thermique', PRODUCTION_SOLAIRE_THERMIQUE, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Solaire thermique', PRODUCTION_SOLAIRE_THERMIQUE, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Solaire thermique', PRODUCTION_SOLAIRE_THERMIQUE, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Autres ENR
  SELECT 'Autres ENR', PRODUCTION_AUTRES_ENR, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autres ENR', PRODUCTION_AUTRES_ENR, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autres ENR', PRODUCTION_AUTRES_ENR, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autres ENR', PRODUCTION_AUTRES_ENR, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autres ENR', PRODUCTION_AUTRES_ENR, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autres ENR', PRODUCTION_AUTRES_ENR, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Chaleur industrielle
  SELECT 'Chaleur industrielle', PRODUCTION_CHALEUR_INDUSTRIEL, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Chaleur industrielle', PRODUCTION_CHALEUR_INDUSTRIEL, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Chaleur industrielle', PRODUCTION_CHALEUR_INDUSTRIEL, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Chaleur industrielle', PRODUCTION_CHALEUR_INDUSTRIEL, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Chaleur industrielle', PRODUCTION_CHALEUR_INDUSTRIEL, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Chaleur industrielle', PRODUCTION_CHALEUR_INDUSTRIEL, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Autre chaleur récupérée
  SELECT 'Autre chaleur récupérée', PRODUCTION_AUTRE_CHALEUR_RECUPEREE, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autre chaleur récupérée', PRODUCTION_AUTRE_CHALEUR_RECUPEREE, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autre chaleur récupérée', PRODUCTION_AUTRE_CHALEUR_RECUPEREE, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autre chaleur récupérée', PRODUCTION_AUTRE_CHALEUR_RECUPEREE, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autre chaleur récupérée', PRODUCTION_AUTRE_CHALEUR_RECUPEREE, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autre chaleur récupérée', PRODUCTION_AUTRE_CHALEUR_RECUPEREE, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Chaudières électriques
  SELECT 'Chaudières électriques', PRODUCTION_CHAUDIERES_ELECTRIQUES, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Chaudières électriques', PRODUCTION_CHAUDIERES_ELECTRIQUES, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Chaudières électriques', PRODUCTION_CHAUDIERES_ELECTRIQUES, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Chaudières électriques', PRODUCTION_CHAUDIERES_ELECTRIQUES, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Chaudières électriques', PRODUCTION_CHAUDIERES_ELECTRIQUES, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Chaudières électriques', PRODUCTION_CHAUDIERES_ELECTRIQUES, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'

  UNION ALL
  -- Autres
  SELECT 'Autres', PRODUCTION_AUTRES, ANNEE
  FROM Conso_chaleur_froid_COM_2018 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autres', PRODUCTION_AUTRES, ANNEE
  FROM Conso_chaleur_froid_COM_2019 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autres', PRODUCTION_AUTRES, ANNEE
  FROM Conso_chaleur_froid_COM_2020 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autres', PRODUCTION_AUTRES, ANNEE
  FROM Conso_chaleur_froid_COM_2021 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autres', PRODUCTION_AUTRES, ANNEE
  FROM Conso_chaleur_froid_COM_2022 WHERE COMMUNE_CODE = '60057'
  UNION ALL
  SELECT 'Autres', PRODUCTION_AUTRES, ANNEE
  FROM Conso_chaleur_froid_COM_2023 WHERE COMMUNE_CODE = '60057'
)

SELECT 
  TYPE_PRODUCTION,
  MAX(CASE WHEN ANNEE = '2018' THEN VALEUR END) as "2018",
  MAX(CASE WHEN ANNEE = '2019' THEN VALEUR END) as "2019",
  MAX(CASE WHEN ANNEE = '2020' THEN VALEUR END) as "2020",
  MAX(CASE WHEN ANNEE = '2021' THEN VALEUR END) as "2021",
  MAX(CASE WHEN ANNEE = '2022' THEN VALEUR END) as "2022",
  MAX(CASE WHEN ANNEE = '2023' THEN VALEUR END) as "2023"
FROM production_data
WHERE VALEUR IS NOT NULL
GROUP BY TYPE_PRODUCTION
ORDER BY TYPE_PRODUCTION;